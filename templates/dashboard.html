{% extends "base.html" %}
{% block title %}MyPlanner - Panel Principal{% endblock %}
{% block content %}
<script>
	tailwind.config = {
		darkMode: "class",
		theme: {
			extend: {
				colors: {
					"primary": "#007BFF",
					"background-light": "#F8F9FA",
					"background-dark": "#111827",
					"card-dark": "#1f2937",
					"card-light": "#FFFFFF"
				},
				fontFamily: {
					"display": ["Inter", "sans-serif"]
				},
				borderRadius: {
					"DEFAULT": "0.5rem",
					"lg": "0.75rem",
					"xl": "1rem",
					"full": "9999px"
				},
			},
		},
	}
</script>

<style>
	/* Estilos para diferenciar tareas de eventos en el calendario */
	.fc .tarea-evento {
		background-color: #10b981 !important;
		border-color: #059669 !important;
	}

	.fc .tarea-evento:hover {
		background-color: #059669 !important;
	}

	/* Mejorar tipograf√≠a del header del calendario */
	.fc .fc-toolbar-title {
		font-family: 'Inter', sans-serif !important;
		font-weight: 700 !important;
	}

	.fc .fc-button {
		font-family: 'Inter', sans-serif !important;
	}
</style>

<!-- Panel Principal -->
<div class="container-fluid">
	<header class="flex flex-col md:flex-row justify-center md:justify-between items-center gap-4 mb-8">
		<p
			class="text-gray-900 text-3xl md:text-4xl font-black leading-tight tracking-tighter text-center md:text-left">
			Panel Principal</p>
		<div class="flex flex-col sm:flex-row items-center gap-3 w-full md:w-auto">

			<!-- Nuevo evento -->
			<a class="flex items-center justify-center gap-2 bg-primary hover:bg-primary/90 text-white text-sm font-medium leading-normal px-4 py-2.5 rounded-lg shadow-sm w-full sm:w-auto"
				href="{{ url_for('crear_evento_view', referer='dashboard') }}">
				<span class="material-symbols-outlined">add_circle</span>
				<span>Nuevo Evento</span>
			</a>

			<!-- Nueva tarea -->
			<a class="flex items-center justify-center gap-2 bg-green-500 hover:bg-green-600 text-white text-sm font-medium leading-normal px-4 py-2.5 rounded-lg shadow-sm w-full sm:w-auto"
				href="{{ url_for('crear_tarea_view', referer='dashboard') }}">
				<span class="material-symbols-outlined">add_task</span>
				<span>Nueva Tarea</span>
			</a>
		</div>
	</header>


	<section class="flex flex-col gap-8">
		<div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
			<!-- Resumen semanal -->
			<div class="bg-card-light p-6 rounded-xl shadow-sm flex flex-col items-start gap-4">
				<h2 class="text-gray-900 text-xl font-bold leading-tight tracking-tight">
					Resumen semanal
				</h2>

				<!-- Tareas completadas/Totales -->
				<div class="grid grid-cols-1 sm:grid-cols-2 gap-4 w-full">
					<div class="bg-primary/10 p-3 rounded-lg flex flex-col items-start justify-center">
						<p class="text-gray-600 text-sm font-medium">Tareas Completadas</p>
						<p class="text-primary text-3xl font-bold" id="contador-tareas">
							{{ completadas_semana }}/{{ total_semana }}
						</p>
					</div>
				<!-- Eventos semana -->
				<div class="bg-yellow-500/10 p-3 rounded-lg flex flex-col items-start justify-center">
					<p class="text-gray-600 text-sm font-medium">Eventos de la Semana</p>
					<p class="text-yellow-500 text-3xl font-bold">
						{{ eventos_semana|length }}
					</p>
				</div>
				</div>
			</div>

			<!-- Tareas de la Semana -->
			<div class="bg-card-light p-6 rounded-xl shadow-sm flex flex-col items-start gap-4">
				<h2 class="text-gray-900 text-[22px] font-bold leading-tight tracking-[-0.015em]">
					Tareas de la Semana
				</h2>

				<!-- Lista de tareas hoy con altura fija y scroll -->
				<div class="flex flex-col gap-2 p-1 w-full max-h-30 overflow-y-auto pr-2">
					{% if tareas_hoy %}
					{% for tarea in tareas_hoy %}
					<div class="flex items-center gap-3 w-full">
						<input type="checkbox"
							class="tarea-checkbox h-5 w-5 rounded border-gray-300 bg-gray-50 text-primary focus:ring-primary focus:ring-offset-background-light cursor-pointer"
							id="tarea-{{ tarea.id }}" data-tarea-id="{{ tarea.id }}" {% if tarea.estado==1 %}checked{%
							endif %} />

						<p
							class="{% if tarea.estado == 1 %}text-gray-500 line-through{% else %}text-gray-800{% endif %}">
							{{ tarea.nombre }}
						</p>

						{% if tarea.prioridad in [3, '3', 'Alta', 'alta'] %}
						<span class="ml-auto text-xs font-medium text-yellow-800 bg-yellow-100 px-1 py-1 rounded-full">
							Alta
						</span>
						{% elif tarea.prioridad in [2, '2', 'Media', 'media'] %}
						<span class="ml-auto text-xs font-medium text-blue-800 bg-blue-100 px-1 py-1 rounded-full">
							Media
						</span>
						{% elif tarea.prioridad in [1, '1', 'Baja', 'baja'] %}
						<span class="ml-auto text-xs font-medium text-green-800 bg-green-100 px-1 py-1 rounded-full">
							Baja
						</span>
						{% else %}
						<span class="ml-auto text-xs font-medium text-gray-800 bg-gray-100 px-1 py-1 rounded-full">
							{{ tarea.prioridad }}
						</span>
						{% endif %}
					</div>
					{% endfor %}
					{% else %}
					<p class="text-gray-500 text-sm">No tienes tareas asignadas para esta semana.</p>
					{% endif %}
				</div>

				<div class="flex justify-end w-full mt-2">
					<a href="{{ url_for('ver_tareas') }}"
						class="bg-green-500 hover:bg-green-600 text-white font-medium py-2 px-2 flex items-center rounded-lg gap-2">
						<span class="material-symbols-outlined">check_circle</span>
						Ver todas las tareas
					</a>
				</div>
			</div>
		</div>




<!-- Calendario - Ocupa todo el ancho -->
<div class="w-full mt-1">
	<div class="bg-card-light p-6 rounded-xl shadow-sm flex flex-col items-start gap-4">
		<h2 class="text-gray-900 text-[22px] font-bold leading-tight tracking-[-0.015em]">
			Calendario
		</h2>
		<div id="calendar" class="w-full overflow-x-auto"></div>
	</div>
</div>
</div>
{% endblock %}